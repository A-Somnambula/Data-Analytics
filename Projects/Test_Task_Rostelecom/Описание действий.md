## Задание №2
Вся обработка таблиц проводилась через редактор PowerQuery в PowerBI с подключением к файлу со всеми таблицами. Таким образом, если исходные данные каким-либо образом изменятся, то PowerQuery автоматически подгрузит изменения при обновлении. Все таблицы были объединены в модель данных, чтобы была возможна фильтрация и отчет был интерактивным.

- Таблица **sales**
  - После загрузки таблицы в PowerQuery стало очевидно, что есть отсутствующие значения в столбце «Номер Заказа». Столбец «Номер Заказа» отфильтрован так, чтобы убрать строки с пустыми значениями, так как их всего лишь 1,01% в данных, а их достоверность вызывает вопросы.
  - Столбец «Date» преобразован так, чтобы отображалась только дата без времени.
  - В столбце «Новостройка» значения NULL заменены на нормальный null.
  - Добавлен столбец год для добавления фильтра в отчет и соединения с новыми таблицами combinations и one_service_in_order.

- Дополнительная таблица **combinations**
	- Таблица создана при помощи дубликации запроса с уже обработанной таблицей sales. 
	- Данная таблица нужная для подсчета пар покупаемых вместе услуг.
	- Преобразование данных сделано через скрипт Python, написанный через PowerQuery, так как других способов создания такой таблицы я не смогла найти.

- Дополнительная таблица **one_service_in_order**
	- Таблица создана при помощи ссылки на запрос с уже обработанной таблицей sales.
	- Таблица обработана при помощи группировки по столбцам «Услуга» и «Год».
	- Данная таблица нужна для подсчета количества продаж, в которых присутствовала только одна услуга.

- Таблица **id**
	- Столбец global_addr_id отфильтрован, чтобы убрать строки с пустыми значениями, так как пустые значения не помогут нам найти «пару» в таблице address.
	- Удалены дубликаты двух столбцов, чтобы можно было соединить таблицу id с таблицей sales по принципу «один-ко-многим».

- Таблица **address**
	- В первую очередь после загрузки таблицы в PowerQuery я заметила, что некоторые адреса неполные. Я решила проверить, будут ли такие адреса попадаться таблице sales. Через ВПР соотнесла нужные id из таблиц и убедилась, что таких нет, однако мое внимание привлекли адреса с буквой «ё» и со словом «квартал» в названии.
	- Все буквы «ё» в столбце address заменены на «е», так как это не мешает определению геопозоции, но помогает избежать ненужных дубликатов.
	- «Квартал Волжский Бульвар 114а» заменен на «Бульвар Волжский», так как тут очевидная ошибка ввода данных.  
